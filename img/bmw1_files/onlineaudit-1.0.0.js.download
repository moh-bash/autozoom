/* BUILD_VERSION '2025.4.1' */
/* BUILD_TIMESTAMP '20250604-071235' */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function n(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,n||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var i=function(t){return t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t}(i||{});const o=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"_logLevel",i.WARN),n(this,"isEmbeddedMode",void 0),n(this,"console",window.console),n(this,"dummy",(function(){})),n(this,"error",this.dummy),n(this,"warn",this.dummy),n(this,"info",this.dummy),n(this,"debug",this.dummy),this.isEmbeddedMode=this._inIframe(),this.setLogLevel(this.getLogLevelConfig())},(r=[{key:"_inIframe",value:function(){try{return window.self!==window.top}catch(t){return!0}}},{key:"_messagePrefix",value:function(){return this.isEmbeddedMode?"[epaas-onlineaudit-embedded]":"[epaas-onlineaudit]"}},{key:"getLogLevelConfig",value:function(){var t="".concat(window.location.search,"-").concat(window.location.hash,"-").concat(document.cookie);return t.includes("epaas.logger=NONE")?i.NONE:t.includes("epaas.logger=ERROR")?i.ERROR:t.includes("epaas.logger=WARN")?i.WARN:t.includes("epaas.logger=INFO")?i.INFO:t.includes("epaas.logger=DEBUG")?i.DEBUG:this._logLevel}},{key:"setLogLevel",value:function(t){var e=this._messagePrefix();this.error=t>=i.ERROR?this.console.error.bind(this.console,e+" - ERROR - %s"):this.dummy,this.warn=t>=i.WARN?this.console.warn.bind(this.console,e+" - WARN  - %s"):this.dummy,this.info=t>=i.INFO?this.console.info.bind(this.console,e+" - INFO  - %s"):this.dummy,this.debug=t>=i.DEBUG?this.console.log.bind(this.console,e+" - DEBUG - %s"):this.dummy,this._logLevel=t}},{key:"isErrorEnabled",value:function(){return this._logLevel>=i.ERROR}},{key:"isWarnEnabled",value:function(){return this._logLevel>=i.WARN}},{key:"isInfoEnabled",value:function(){return this._logLevel>=i.INFO}},{key:"isDebugEnabled",value:function(){return this._logLevel>=i.DEBUG}}])&&e(t.prototype,r),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,o}());function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function c(t,e,n){return(e=l(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){var e=function(t,e){if("object"!=a(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==a(e)?e:e+""}var s=function(t){return t.EVENT_INITIALIZED="onlineaudit.api.initialized",t}({});const f=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"initialized",!1),c(this,"initializeFailed",!1),c(this,"eventListeners",[])},e=[{key:"addEventListener",value:function(t,e){if(t)if(e){if(t===s.EVENT_INITIALIZED){if(this.initialized)return void this.wrapCallBack(e,this.createInitializedEvent(this));if(this.initializeFailed)return void this.wrapCallBack(e,this.createInitializedEvent(void 0))}this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(e)}else o.warn("addEventListener: eventCallback should not be null.");else o.warn("addEventListener: eventType should not be empty or null.")}},{key:"removeEventListener",value:function(t,e){if(t)if(e){var n=this.eventListeners[t];if(n)for(var r=n.length-1;r>=0;r--)n[r]===e&&n.splice(r,1)}else o.warn("removeEventListener: eventCallback should not be null.");else o.warn("removeEventListener: eventType should not be empty or null.")}},{key:"triggerApiInitializedEvent",value:function(){var t;this.setInitialized(!0),t=window.epaas.onlineaudit&&window.epaas.onlineaudit.api?this.createInitializedEvent(window.epaas.onlineaudit.api):this.createInitializedEvent(this),o.debug("initialization ok - delivering api in initialized event",t),this.dispatchEvent(s.EVENT_INITIALIZED,t)}},{key:"wrapCallBack",value:function(t,e){try{t(e)}catch(t){o.warn("caught exception while executing addEventListener callback",t)}}},{key:"createInitializedEvent",value:function(t){return this.createEvent(s.EVENT_INITIALIZED,t)}},{key:"createEvent",value:function(t,e){try{return new CustomEvent(t,{detail:e})}catch(r){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,{detail:e}),n}}},{key:"setInitialized",value:function(t){this.initializeFailed?this.initialized=!1:this.initialized=t}},{key:"dispatchEvent",value:function(t,e){var n=this.eventListeners[t];if(n)for(var r=n.map((function(t){return t})),i=0;i<r.length;i++)try{r[i](e)}catch(t){o.warn("caught exception while executing dispatchEvent callback",t)}try{window.dispatchEvent(e)}catch(t){o.warn("caught exception while executing window.dispatchEvent",t)}}},{key:"fireInitFailedEvent",value:function(){this.setInitialized(!1),this.setInitializeFailed(!0);var t=this.createInitializedEvent(void 0);o.info("initialization failed - firing empty initialized event",t),this.dispatchEvent(s.EVENT_INITIALIZED,t)}},{key:"setInitializeFailed",value:function(t){this.initializeFailed=t}}],e&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}());function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */h=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),u=new B(r||[]);return i(a,"_invoke",{value:L(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var y="suspendedStart",p="suspendedYield",d="executing",g="completed",b={};function m(){}function w(){}function E(){}var S={};l(S,a,(function(){return this}));var k=Object.getPrototypeOf,O=k&&k(k(A([])));O&&O!==n&&r.call(O,a)&&(S=O);var x=E.prototype=m.prototype=Object.create(S);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(i,o,a,u){var c=f(t[i],t,o);if("throw"!==c.type){var l=c.arg,s=l.value;return s&&"object"==v(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,u)}))}u(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,n,r){var i=y;return function(o,a){if(i===d)throw Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var c=N(u,r);if(c){if(c===b)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===y)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var l=f(e,n,r);if("normal"===l.type){if(i=r.done?g:p,l.arg===b)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=g,r.method="throw",r.arg=l.arg)}}}function N(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,N(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var o=f(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=E,i(x,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:w,configurable:!0}),w.displayName=l(E,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,l(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},j(P.prototype),l(P.prototype,u,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new P(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(x),l(x,c,"Generator"),l(x,a,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},e}function y(t,e,n,r,i,o,a){try{var u=t[o](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,i)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d(r.key),r)}}function d(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:e+""}var g=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getData",value:(r=h().mark((function t(e){var n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if((n=t.sent).ok){t.next=6;break}throw new Error("Error: ".concat(n.status," ").concat(n.statusText));case 6:return t.next=8,n.json();case 8:return t.abrupt("return",t.sent);case 11:t.prev=11,t.t0=t.catch(0),o.info("Fetch error:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){y(o,n,i,a,u,"next",t)}function u(t){y(o,n,i,a,u,"throw",t)}a(void 0)}))},function(t){return i.apply(this,arguments)})},{key:"postData",value:function(t,e){fetch(t,{method:"POST",body:JSON.stringify(e)}).catch((function(t){o.info("Post error:",t)}))}}],e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function w(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==b(e)?e:e+""}function S(){var t=document.currentScript;if(t)return t;var e=document.getElementsByTagName("script");return e[e.length-1]}var k=new(function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),w(this,"config",void 0),w(this,"publicPath",void 0),w(this,"currentScriptApiVersion",void 0),this.config=null,this.publicPath=e,this.currentScriptApiVersion=n},(e=[{key:"initialize",value:function(t){this.config=t}},{key:"getPublicPath",value:function(){return this.publicPath}},{key:"getCurrentScriptApiVersion",value:function(){return this.currentScriptApiVersion}},{key:"activationProbability",get:function(){var t,e;return null!==(t=this.config)&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&t.activationProbability?null===(e=this.config)||void 0===e||null===(e=e.config)||void 0===e?void 0:e.activationProbability:0}},{key:"queueFilter",get:function(){var t;return null===(t=this.config)||void 0===t||null===(t=t.config)||void 0===t?void 0:t.queueFilter}},{key:"queuesSpecification",get:function(){var t;return null===(t=this.config)||void 0===t?void 0:t.queuesSpecification}},{key:"frontendBatchIntervalSecs",get:function(){var t,e;return null!==(t=this.config)&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&t.frontendBatchIntervalSecs?null===(e=this.config)||void 0===e||null===(e=e.config)||void 0===e?void 0:e.frontendBatchIntervalSecs:30}},{key:"frontendBatchSize",get:function(){var t,e;return null!==(t=this.config)&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&t.frontendBatchSize?null===(e=this.config)||void 0===e||null===(e=e.config)||void 0===e?void 0:e.frontendBatchSize:20}}])&&m(t.prototype,e),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())(function(){var t=S();if(t){var e=document.createElement("a");return e.href=t.src,"localhost"===e.hostname?e.protocol+"//"+e.hostname+":3003/":e.origin?e.origin+"/":e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")+"/"}return"/"}(),function(){var t=S();if(!t)return"";var e=t.getAttribute("src"),n=e?e.match(/onlineaudit-(\d+\.\d+\.\d+)\.js/):void 0;return n?n[1]:""}());function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,N(r.key),r)}}function P(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function L(t,e,n){return(e=N(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}var I=function(){return P((function t(){x(this,t),L(this,"endpoint",void 0),L(this,"http",void 0),this.http=new g,this.endpoint="".concat(k.getPublicPath(),"epaas")}),[{key:"getTimestamp",value:function(){var t=new Date,e=t.toISOString();return e.substring(0,e.indexOf(":"))+":"+this.pad2(20*Math.floor(t.getUTCMinutes()/20))+":00Z"}},{key:"pad2",value:function(t){return t<10?"0"+t:""+t}},{key:"get",value:function(t){return this.http.getData(t)}},{key:"post",value:function(t,e){this.http.postData(t,e)}}])}();const T=new(function(){return P((function t(){x(this,t),L(this,"service",void 0),this.service=new I}),[{key:"getConfigByTimestamp",value:function(){var t="".concat(this.service.endpoint,"/onlineaudit/config/").concat(this.service.getTimestamp(),".epaas.json");return this.service.get(t)}},{key:"sendEventBatches",value:function(t){var e="".concat(this.service.endpoint,"/onlineaudit/producer/ingest-events"),n=this.replaceFieldName(t);this.addField(n),this.service.post(e,n)}},{key:"addField",value:function(t){var e="r".concat("i").concat("d");t[e]=this.generateUUID();var n=t[e];delete t[e];var r=JSON.stringify(t),i=this.generateHash(r);t[e]=this.formatLeastSigBits(n,i)}},{key:"generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}},{key:"generateHash",value:function(t){for(var e=t,n=0n,r=0;r<e.length;r++)n+=BigInt(e.charCodeAt(r)*r)%BigInt(Math.pow(2,64));return n}},{key:"formatLeastSigBits",value:function(t,e){var n=t.split("-"),r=e.toString("16").padStart(16,"0");return"".concat(n[0],"-").concat(n[1],"-").concat(n[2],"-").concat(r.substring(0,4),"-").concat(r.substring(4))}},{key:"isFieldEmptyOrDash",value:function(t){return""===t||null===t||"-"===t}},{key:"replaceFieldName",value:function(t){var e=this,n=JSON.parse(JSON.stringify(t)),r={},i=k.queuesSpecification,o=function(t){var o=function(){var o=n[t][a];Object.keys(o).forEach((function(n){if(null!=i[t]&&null!=i[t]){var a=i[t].schema.fields.find((function(t){return t.name===n}));a&&a.shortName&&(o[a.shortName]=o[n],delete o[n]),a&&null!=a&&a.common&&a.shortName&&(a.shortName in r&&!e.isFieldEmptyOrDash(r[a.shortName])||(r[a.shortName]=o[a.shortName]),delete o[a.shortName])}}))};for(var a in n[t])o()};for(var a in n)o(a);return 0!==Object.keys(r).length&&(n.globalcommon=[r]),n}}])}());function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function F(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==B(e)?e:e+""}var _=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"push",value:function(t){o.debug("Inactive Queue push event - will be lost",t)}}])&&A(t.prototype,e),n&&A(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function z(t,e,n){return(e=R(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R(t){var e=function(t,e){if("object"!=C(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==C(e)?e:e+""}var D=function(){return t=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),z(this,"queueFilter",void 0),z(this,"queueName",void 0),z(this,"mapFilterRegexp",new Map);var r=k;if(this.queueName=e,r.queueFilter&&(this.queueFilter=r.queueFilter[e],this.queueFilter)){var i=function(){var t=[];n.queueFilter[o].forEach((function(e){return t.push(new RegExp(e))})),n.mapFilterRegexp.set(o,t)};for(var o in this.queueFilter)i()}},(e=[{key:"filter",value:function(t){var e,n=this,r=function(){var e=t[i],r=n.mapFilterRegexp.get(i);if(r&&(void 0===e||!r.some((function(t){return t.test(e)}))))return{v:!1}};for(var i in this.queueFilter)if(e=r())return e.v;return!0}}])&&q(t.prototype,e),n&&q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,U(r.key),r)}}function U(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==G(e)?e:e+""}var V=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"supports",value:function(t){return"exists"===t}},{key:"aggregateEvent",value:function(t,e){}},{key:"resetAggregatedEvent",value:function(t){}}])&&M(t.prototype,e),n&&M(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Z(r.key),r)}}function Z(t){var e=function(t,e){if("object"!=W(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==W(e)?e:e+""}var Q=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"supports",value:function(t){return"count"===t}},{key:"aggregateEvent",value:function(t,e){e.count?e.count++:e.count=1}},{key:"resetAggregatedEvent",value:function(t){t.count=0}}])&&K(t.prototype,e),n&&K(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Y(r.key),r)}}function Y(t){var e=function(t,e){if("object"!=H(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==H(e)?e:e+""}var $=new(function(){return t=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r=void 0,(n=Y(n="aggregationFunctions"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,this.aggregationFunctions=[new V,new Q],f.addEventListener("onlineaudit.internal.batchSent",(function(t){return i.resetAggregatedEvents(t.detail)}))},(e=[{key:"getEventAggregationKey",value:function(t,e){return k.queuesSpecification[e].aggregation.groupBy.map((function(e){return t[e]})).join(",")}},{key:"aggregateEvent",value:function(t,e,n){var r=k.queuesSpecification[n].aggregation.fieldOperations.action,i=this.aggregationFunctions.find((function(t){return t.supports(r)}));i&&i.aggregateEvent(t,e)}},{key:"resetAggregatedEvents",value:function(t){var e=this;for(var n in t){var r=function(){var r=t[n][i];o.info("Reset Aggregated Event for queueName [",n,"] : ",r);var a=k.queuesSpecification[n].aggregation.fieldOperations.action,u=e.aggregationFunctions.find((function(t){return t.supports(a)}));u&&u.resetAggregatedEvent(r)};for(var i in t[n])r()}}}])&&J(t.prototype,e),n&&J(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}());function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nt(r.key),r)}}function et(t,e,n){return(e=nt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nt(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==X(e)?e:e+""}var rt=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),et(this,"eventBatch","onlineaudit.internal.batchSent"),et(this,"queueEventBatches",void 0),et(this,"existingEventKeys",void 0),et(this,"intervalId",void 0),this.queueEventBatches={},this.existingEventKeys=new Map,this.setupInterval(),this.setupPageUnloadHandler()},e=[{key:"addToBatch",value:function(t,e,n){this.queueEventBatches[n]||(this.queueEventBatches[n]=[]),this.existingEventKeys.has(n)||this.existingEventKeys.set(n,new Set);var r=this.existingEventKeys.get(n);r.has(e)||(this.queueEventBatches[n].push(t),r.add(e),Object.values(this.queueEventBatches).flatMap((function(t){return t})).length>=k.frontendBatchSize&&this.sendEventBatchesToBackend())}},{key:"setupInterval",value:function(){var t=this;this.intervalId=setInterval((function(){return t.sendEventBatchesToBackend()}),1e3*k.frontendBatchIntervalSecs)}},{key:"resetInterval",value:function(){clearInterval(this.intervalId),this.setupInterval()}},{key:"sendEventBatchesToBackend",value:function(){try{o.info("sendEventBatchesToBackend checking if there are events to send");var t=Object.values(this.queueEventBatches).flat().length;if(t>0){o.info("sendEventBatchesToBackend Sending event batch [",t,"]"),T.sendEventBatches(this.queueEventBatches);var e=f.createEvent(this.eventBatch,this.queueEventBatches);f.dispatchEvent(this.eventBatch,e),this.queueEventBatches={},this.existingEventKeys.clear(),this.resetInterval()}}catch(t){o.warn("failed sendEventBatchesToBackend ",t)}}},{key:"setupPageUnloadHandler",value:function(){var t=this;window.addEventListener("beforeunload",(function(){o.debug("beforeunload triggered"),t.sendEventBatchesToBackend()}))}}],e&&tt(t.prototype,e),n&&tt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}());function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ct(r.key),r)}}function ut(t,e,n){return(e=ct(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ct(t){var e=function(t,e){if("object"!=it(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=it(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==it(e)?e:e+""}var lt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut(this,"eventFilter",void 0),ut(this,"queueName",void 0),ut(this,"aggregatedMap",new Map),this.queueName=e,this.eventFilter=new D(e)},e=[{key:"push",value:function(t){if(this.eventFilter.filter(t)){var e=$.getEventAggregationKey(t,this.queueName),n=this.aggregatedMap.get(e);n||(n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){ut(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t),this.aggregatedMap.set(e,n)),$.aggregateEvent(t,n,this.queueName),rt.addToBatch(n,e,this.queueName),o.info("Active Queue [",this.queueName,"] push object ",t,n)}}}],e&&at(t.prototype,e),n&&at(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function ft(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return vt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ht(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ht=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new I(r||[]);return i(a,"_invoke",{value:j(t,n,u)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var v="suspendedStart",h="suspendedYield",y="executing",p="completed",d={};function g(){}function b(){}function m(){}var w={};l(w,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(T([])));S&&S!==n&&r.call(S,a)&&(w=S);var k=m.prototype=g.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(i,o,a,u){var c=f(t[i],t,o);if("throw"!==c.type){var l=c.arg,s=l.value;return s&&"object"==st(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,u)}))}u(c.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function j(e,n,r){var i=v;return function(o,a){if(i===y)throw Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var c=P(u,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===v)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var l=f(e,n,r);if("normal"===l.type){if(i=r.done?p:h,l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=p,r.method="throw",r.arg=l.arg)}}}function P(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,P(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=f(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,d;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(st(e)+" is not iterable")}return b.prototype=m,i(k,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:b,configurable:!0}),b.displayName=l(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},O(x.prototype),l(x.prototype,u,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new x(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;N(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),d}},e}function yt(t,e,n,r,i,o,a){try{var u=t[o](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,i)}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dt(r.key),r)}}function dt(t){var e=function(t,e){if("object"!=st(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==st(e)?e:e+""}var gt=new(function(){return t=function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r=void 0,(n=dt(n="settings"))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,o.info("Start OnlineAuditApi"),this.settings=k,this.initialize()},e=[{key:"initialize",value:(r=ht().mark((function t(){var e;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.getConfigByTimestamp();case 3:if(e=t.sent){t.next=6;break}throw new Error("Error getting config");case 6:this.settings.initialize(e),f.triggerApiInitializedEvent(),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),o.info("ePaas-onlineaudit Initialization failed:",t.t0),f.fireInitFailedEvent();case 14:case"end":return t.stop()}}),t,this,[[0,10]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){yt(o,n,i,a,u,"next",t)}function u(t){yt(o,n,i,a,u,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"connect",value:function(t){o.debug("Connecting...");var e=this.checkVersionCompatibility(),n=this.checkActivationProbability();if(e&&n){for(var r in t){var i=t[r];if(Array.isArray(i)){var a,u=new lt(r),c=ft(i);try{for(c.s();!(a=c.n()).done;){var l=a.value;u.push(l)}}catch(t){c.e(t)}finally{c.f()}t[r]=u}else i instanceof lt||(t[r]=new lt(r))}o.debug("Online-Audit Api connected")}else o.debug("Online-Audit Api did not connect: versionCheck "+e+", activationProbabilityCheck "+n),this.inactivateQueues(t)}},{key:"checkActivationProbability",value:function(){return 100*Math.random()<this.settings.activationProbability}},{key:"checkVersionCompatibility",value:function(){var t,e=!0;return(null===(t=this.settings.config)||void 0===t?void 0:t.apiVersion)!==this.getCurrentScriptApiVersion()&&(e=!1),e}},{key:"disconnect",value:function(t){o.debug("Disconnecting..."),this.inactivateQueues(t),rt.sendEventBatchesToBackend()}},{key:"inactivateQueues",value:function(t){for(var e in t)t[e]=new _}},{key:"addEventListener",value:function(t,e){f.addEventListener(t,e)}},{key:"removeEventListener",value:function(t,e){f.removeEventListener(t,e)}},{key:"getCurrentScriptApiVersion",value:function(){return this.settings.getCurrentScriptApiVersion()}}],e&&pt(t.prototype,e),n&&pt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}());window.epaas=window.epaas||{},window.epaas.onlineaudit=window.epaas.onlineaudit||{},window.epaas.onlineaudit.api=gt})();